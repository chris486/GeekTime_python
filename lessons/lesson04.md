# 字典与集合

### 字典和集合的基础

字典：一系列无序元素的组合，其长度大小可变，元素可以任意地删减和改变。
集合：一系列无序的、唯一的元素组合。

字典元素的访问
- 直接索引键：`dict['key']`
- 使用函数索引：`dict.get(key,default)`

**集合并不支持索引操作，因为集合本质上是一个哈希表**

`value in dict/set`：判断元素是否在字典/集合内

**集合的 pop() 操作是删除集合中最后一个元素，可是集合本身是无序的，无法知道会删除哪个元素，因此这个操作得谨慎使用。**

排序：
字典：本身是无序的，排序后返回一个列表。列表中的每个元素，是由原字典的键和值组成的元组
集合：本身是无序的，排序后返回一个列表。

> 3.7 之后的 python 字典是有序的！！！

`_sorted_by_key`：字典按键升序排序
`_sorted_by_value`：字典按值升序排序
`sorted(set)`：集合升序排序

### 字典和集合的性能

N 个元素的列表，遍历列表的时间复杂度是 O(n)；二分查找的时间复杂度是 O(logn);
N 个元素的字典，查找一个元素的时间复杂度是 O(1);

### 字典和集合的工作原理

插入操作
- 每次向字典或集合插入一个元素时，Python 会首先计算键的哈希值（hash(key)），再和 mask = PyDicMinSize - 1 做与操作，计算这个元素应该插入哈希表的位置 index = hash(key) & mask。如果哈希表中此位置是空的，那么这个元素就会被插入其中。
而如果此位置已被占用，Python 便会比较两个元素的哈希值和键是否相等。
若两者都相等，则表明这个元素已经存在，如果值不同，则更新值。
若两者中有一个不相等，这种情况我们通常称为哈希冲突（hash collision），意思是两个元素的键不相等，但是哈希值相等。这种情况下，Python 便会继续寻找表中空余的位置，直到找到位置为止。

查找操作
- Python 会根据哈希值，找到其应该处于的位置；然后，比较哈希表这个位置中元素的哈希值和键，与需要查找的元素是否相等。如果相等，则直接返回；如果不等，则继续查找，直到找到空位或者抛出异常为止。

删除操作
- 对于删除操作，Python 会暂时对这个位置的元素，赋于一个特殊的值，等到重新调整哈希表的大小时，再将其删除。

